<html>
  <head>
    <title>Waves</title>
    <script src="https://cdn.jsdelivr.net/npm/p5@1.3.1/lib/p5.js"></script>
  </head>
  <body>
    <script>
      let width = 640*2;
      let height = 480*2;

      let wavesShader;
      let cam;

      function preload(){
        wavesShader = loadShader('/waves.vert', '/waves.frag');
      }

      function setup() {
        createCanvas(width, height, WEBGL);
        noStroke();

        cam = createCapture(VIDEO);
        cam.size(width, height);

        cam.hide();
      }

      function draw() {
        background(220);
        // image(cam, 0, 0, width, height);
        
        shader(wavesShader);
        wavesShader.setUniform('tex0', cam);

        rect(0,0,width,height);
      }

      new p5();
    </script>    
  </body>
</html>